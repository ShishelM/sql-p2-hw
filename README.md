# Домашнее задание к занятию "`SQL. Часть 2`" - `Рыбянцев Павел`

---

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию: 
- фамилия и имя сотрудника из этого магазина;
- город нахождения магазина;
- количество пользователей, закреплённых в этом магазине.

```sql
select CONCAT(s.last_name, ' ', s.first_name) "employee", c2.city,  count(*) "count_customers"
from customer c
join staff s on c.store_id = s.store_id
join store s2 on c.store_id = s2.store_id 
join address a on s2.address_id = a.address_id 
join city c2 on a.city_id = c2.city_id 
group by c.store_id, 1, 2
HAVING count(c.store_id) > 300
```
```
employee    |city      |count_customers|
------------+----------+---------------+
Hillyer Mike|Lethbridge|            326|
```
### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

### Задание 4*

Посчитайте количество продаж, выполненных каждым продавцом. Добавьте вычисляемую колонку «Премия». Если количество продаж превышает 8000, то значение в колонке будет «Да», иначе должно быть значение «Нет».

### Задание 5*

Найдите фильмы, которые ни разу не брали в аренду.